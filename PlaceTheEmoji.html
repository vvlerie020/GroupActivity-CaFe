<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Place The Emoji</title>
<link rel="icon" type="image/x-icon" href="pics/cover.jpg">
<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
}

/* MENU */
#menuBtn {
    position: fixed;
    top: 10px;
    left: 10px;
    z-index: 1000;
}

#menu {
    position: fixed;
    top: 45px;
    left: 10px;
    background: white;
    border: 1px solid #ccc;
    display: none;
    z-index: 1000;
}

#menu button {
    display: block;
    width: 180px;
    padding: 10px;
    border: none;
    background: none;
    text-align: left;
    cursor: pointer;
}

section {
    display: none;
    height: 100vh;
    align-items: center;
    justify-content: center;
    flex-direction: column;
}

section.active { display: flex; }

button {
    padding: 10px 20px;
    margin: 8px;
    cursor: pointer;
}

/* SCORES AND TURN BOXES */
#scoresContainer {
    display: flex;
    justify-content: space-around;
    width: 80%;
    margin-bottom: 10px;
}

.scoreBox {
    padding: 15px 20px;
    border-radius: 20px;
    background-color: rgba(255,255,255,0.8);
    font-weight: bold;
    min-width: 120px;
    text-align: center;
}

#turnRoundContainer {
    display: flex;
    justify-content: space-around;
    width: 80%;
    margin-bottom: 15px;
}

.roundBox {
    padding: 10px 15px;
    border-radius: 15px;
    background-color: rgba(255,255,255,0.8);
    font-weight: bold;
    min-width: 120px;
    text-align: center;
}

/* GAME LAYOUT */
#placement-area {
    display: flex;
    margin: 15px;
}

.slot {
    width: 80px;
    height: 80px;
    border: 2px solid black;
    margin: 5px;
    background: white;
    cursor: pointer;
}

.slot.locked {
    border-color: green;
    cursor: default;
}

#pool {
    display: flex;
    flex-wrap: wrap;
    width: 80%;
    justify-content: center;
}

.image-piece {
    width: 70px;
    height: 70px;
    margin: 5px;
    border: 1px solid #aaa;
    cursor: pointer;
}

.image-piece.selected {
    border: 3px solid blue;
    opacity: 0.7;
}

.image-piece img,
.slot img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

/* BACKGROUNDS */
#cover {
    background-image: url("pics/coverr.png");
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
}

#home {
    background-image: url("pics/select.jpg");
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
}

#game {
    background-image: url("pics/back.png");
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
}

/* PLAY BUTTON */
#playBtn {
    margin-top: 30%;
    border-radius: 20px;
}
</style>
</head>

<body>

<button id="menuBtn" style="background-color: rgba(255, 255, 255, 0.432); border-radius: 20px;">â˜° Menu</button>
<div id="menu">
    <button id="howBtn">How to Play</button>
    <button id="aboutBtn">About</button>
    <button id="homeBtn">Back to Home</button>
</div>

<!-- COVER PAGE -->
<section id="cover" class="active">
    <button id="playBtn" style="font-size: 30px; border-radius: 50px; margin-top: 30%;
    background-color: rgba(221, 160, 221, 0.495);">Play</button>
</section>

<!-- MODE / ENTER NAME PAGE -->
<section id="home">
    <h1 id="homeTitle" style="color: #ededed;">Select Mode</h1>

    <div id="modeButtons">
        <button id="singleBtn" style="background-color: rgba(221, 160, 221, 0.354);">Single Player</button>
        <button id="multiBtn" style="background-color: rgba(221, 160, 221, 0.354); ">Multiplayer</button>
    </div>

    <div id="registration" style="display:none;">
        <input id="p1Input" placeholder="Player 1 Name">
        <input id="p2Input" placeholder="Player 2 Name">
        <button id="startBtn" style="background-color: rgba(221, 160, 221, 0.354); ">Start Game</button>
    </div>
</section>

<!-- GAME PAGE -->
<section id="game">
    <div id="scoresContainer">
        <div class="scoreBox" id="p1Score" style="margin-right: 500px;"></div>
        <div class="scoreBox" id="p2Score"></div>
    </div>

    <div id="turnRoundContainer">
        <div class="roundBox" id="turn" style="margin-right: 500px;"></div>
        <div class="roundBox" id="round" ></div>
    </div>

    <div id="placement-area" style="margin-top: 50px;"></div>
    <div id="pool" style="margin-top: 50px;"></div>

    <button id="submitBtn" style="border-radius: 20px; background-color: rgba(221, 160, 221, 0.354);
    margin-top: 50px;">Submit Guess</button>
</section>

<script>
/* ---------- DOM ---------- */
const cover = document.getElementById('cover');
const home = document.getElementById('home');
const game = document.getElementById('game');

const playBtn = document.getElementById('playBtn');
const singleBtn = document.getElementById('singleBtn');
const multiBtn = document.getElementById('multiBtn');
const startBtn = document.getElementById('startBtn');
const submitBtn = document.getElementById('submitBtn');

const menuBtn = document.getElementById('menuBtn');
const menu = document.getElementById('menu');
const howBtn = document.getElementById('howBtn');
const aboutBtn = document.getElementById('aboutBtn');
const homeBtn = document.getElementById('homeBtn');

const homeTitle = document.getElementById('homeTitle');
const modeButtons = document.getElementById('modeButtons');
const registration = document.getElementById('registration');
const p1Input = document.getElementById('p1Input');
const p2Input = document.getElementById('p2Input');

const p1Score = document.getElementById('p1Score');
const p2Score = document.getElementById('p2Score');
const turnEl = document.getElementById('turn');
const roundEl = document.getElementById('round');
const placementArea = document.getElementById('placement-area');
const poolEl = document.getElementById('pool');

/* ---------- GAME DATA ---------- */
const images = [
    'pics/bigteeth.jpg','pics/chinpoint.jpg','pics/flirty.jpg',
    'pics/floewerteeth.jpg','pics/gahaman.jpg','pics/happy.jpg',
    'pics/inlove.jpg','pics/pacute.jpg','pics/shhkindat.jpg','pics/thinking.jpg'
];

let players = [];
let scores = [0,0];
let currentPlayer = 0;
let round = 1;
let mode = '';
let hidden = [], pool = [], placement = [], locked = [];
let selectedImage = null;
let aiThinking = false;

/* ---------- HELPERS ---------- */
const shuffle = a => a.sort(() => Math.random() - 0.5);
const show = s => {
    [cover,home,game].forEach(x=>x.classList.remove('active'));
    s.classList.add('active');
};

/* ---------- MENU ---------- */
menuBtn.onclick = () => menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
howBtn.onclick = () => alert('Each round has empty slots and a set of emoji choices. Your goal is to guess the correct positions of the emojis to earn points. When you place an emoji in the correct position, you earn points and the emoji stays in the slot. If the placement is wrong, the emoji returns to the choices. The game continues through all rounds until Round 3. Good luck!');
aboutBtn.onclick = () => alert(
  'The Emoji Guessing Game is a fun and easy \'game\' where players match silly face emojis to the correct empty boxes by tapping.\n' +
  'The boxes at the top have no emojis, while the emojis are shown below. Players must guess where each emoji should be placed by tapping the emoji and the correct box.\n' +
  'The goal of the game is to guess correctly and enjoy matching the silly emoji faces.\n\n' +
  'Created by Group CaFe:\n' +
  'Grace Camacho\n' +
  'Elisha Fernandez\n' +
  'Clarence Cabatay'
);

homeBtn.onclick = () => location.reload();

/* ---------- FLOW ---------- */
playBtn.onclick = () => show(home);

singleBtn.onclick = () => {
    mode = 'single';
    homeTitle.textContent = 'Enter Name';
    modeButtons.style.display = 'none';
    registration.style.display = 'block';
    p2Input.style.display = 'none';
};

multiBtn.onclick = () => {
    mode = 'multi';
    homeTitle.textContent = 'Enter Names';
    modeButtons.style.display = 'none';
    registration.style.display = 'block';
    p2Input.style.display = 'block';
};

startBtn.onclick = () => {
    if (!p1Input.value.trim()) { alert("Player 1 name is required!"); return; }
    if (mode==='multi' && !p2Input.value.trim()) { alert("Player 2 name is required!"); return; }

    players = [
        p1Input.value.trim(),
        mode === 'single' ? 'Computer' : p2Input.value.trim()
    ];
    show(game);
    initRound();
};

/* ---------- ROUND ---------- */
function initRound() {
    const slots = round === 1 ? 4 : round === 2 ? 6 : 8;
    shuffle(images);
    hidden = images.slice(0, slots);
    pool = [...hidden, ...images.slice(slots, slots + 2)];
    shuffle(pool);

    placement = Array(slots).fill(null);
    locked = Array(slots).fill(false);
    currentPlayer = 0;
    aiThinking = false;
    render();
}

/* ---------- RENDER ---------- */
function render() {
    p1Score.textContent = `${players[0]}: ${scores[0]}`;
    p2Score.textContent = `${players[1]}: ${scores[1]}`;
    turnEl.textContent = `${players[currentPlayer]}'s turn`;
    roundEl.textContent = `Round ${round}`;

    placementArea.innerHTML = '';
    placement.forEach((img,i)=>{
        const s=document.createElement('div');
        s.className='slot'+(locked[i]?' locked':'');
        s.dataset.index=i;
        if(img) s.innerHTML=`<img src="${img}">`;
        placementArea.appendChild(s);
    });

    poolEl.innerHTML='';
    pool.forEach(img=>{
        const p=document.createElement('div');
        p.className='image-piece';
        p.dataset.img=img;
        p.innerHTML=`<img src="${img}">`;
        poolEl.appendChild(p);
    });

    submitBtn.disabled = aiThinking;
}

/* ---------- PLAYER INPUT ---------- */
poolEl.onclick = e => {
    if (aiThinking) return;
    const p=e.target.closest('.image-piece');
    if(!p) return;
    document.querySelectorAll('.image-piece').forEach(x=>x.classList.remove('selected'));
    p.classList.add('selected');
    selectedImage=p.dataset.img;
};

placementArea.onclick = e => {
    if (aiThinking) return;
    const s=e.target.closest('.slot');
    if(!s) return;
    const i=+s.dataset.index;
    if(locked[i]) return;

    if(placement[i]){
        pool.push(placement[i]);
        placement[i]=null;
    } else if(selectedImage){
        placement[i]=selectedImage;
        pool.splice(pool.indexOf(selectedImage),1);
        selectedImage=null;
    }
    render();
};

/* ---------- SUBMIT ---------- */
submitBtn.onclick = () => {
    let wrong=false;

    placement.forEach((img,i)=>{
        if(img===hidden[i]){
            if(!locked[i]){
                scores[currentPlayer]+=10;
                locked[i]=true;
            }
        } else if(img){
            pool.push(img);
            placement[i]=null;
            wrong=true;
        }
    });

    if(wrong) currentPlayer = (currentPlayer+1)%2;

    if(mode==='single' && currentPlayer===1){
        aiThinking=true;
        render();
        setTimeout(aiTurn,1500);
        return;
    }

    if(locked.every(Boolean)){
        round++;
        if(round>3){ alert('Game Over'); location.reload(); }
        else initRound();
        return;
    }

    render();
};

/* ---------- AI TURN ---------- */
function aiTurn(){
    placement.forEach((img,i)=>{
        if(img===null && !locked[i]){
            let choice;
            if(pool.includes(hidden[i]) && Math.random()<0.1){
                choice = hidden[i];
            } else {
                choice = pool[Math.floor(Math.random()*pool.length)];
            }
            placement[i]=choice;
            pool.splice(pool.indexOf(choice),1);
        }
    });

    placement.forEach((img,i)=>{
        if(img===hidden[i]){
            if(!locked[i]){
                scores[currentPlayer]+=10;
                locked[i]=true;
            }
        } else if(img){
            pool.push(img);
            placement[i]=null;
        }
    });

    currentPlayer=0;
    aiThinking=false;

    if(locked.every(Boolean)){
        round++;
        if(round>3){ alert('Game Over'); location.reload(); }
        else initRound();
        return;
    }

    render();
}
</script>
</body>
</html>
